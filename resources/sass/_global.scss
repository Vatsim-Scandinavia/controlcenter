// Global component styles

html {
    position: relative;
    min-height: 100%;
    background-color: $gray-100;
}

body {
    height: 100%;
    background-color: $gray-100;
}

p {
    a {
        text-decoration: underline;
    }
}

.page-title{

    flex-direction: row;
    flex-wrap: wrap;

    h3{
        margin-bottom: 1.5rem;
    }

    @include media-breakpoint-down(sm) {

        h3{
            margin-bottom: 0.5rem;
            margin-right: 1.5rem;
        }

        div{
            margin-bottom: 1.5rem;
        }
    }
}

form {
    input, select {
        border-color: $gray-400 !important;
    }
}

.accordion button{
    text-decoration: none;
}

#markdown-content ul li a, #markdown-improve ul li a {
    text-decoration: underline;
}

dl dd.separator{
    border-bottom: 1px solid $primary;
}

dl.copyable{

    a {
        text-decoration: none;
        &:hover{
            text-decoration: underline;
        }
    }

    dd button, dd a.link-btn, dt a{
        background: transparent;
        border: none;
        visibility: hidden;
    }

    dd:hover button, dd:hover a.link-btn, dt:hover a{

        visibility: visible;
        color: $gray-400;

        &:hover{
            color: $gray-500;
        }

        &:active{
            color: $success;
        }
    }
}


// Main page wrapper
#wrapper {
    display: flex;
    #content-wrapper {
        background-color: $gray-100;
        width: 100%;
        overflow-x: hidden;
        #content {
            flex: 1 0 auto;
        }
    }
}

// Dark theme overrides
// This must come after Bootstrap to override Bootstrap's CSS variable definitions
:root[data-theme="dark"],
[data-theme="dark"] {
    // Force override Bootstrap's CSS variables (must come after Bootstrap import)
    --bs-body-bg: #1a1a1a;
    --bs-card-cap-bg: #2d2d2d;
    
    // Base colors - apply to html and body
    html {
        background-color: #1a1a1a !important;
    }
    
    body {
        background-color: #1a1a1a !important;
        color: var(--bs-body-color) !important;
    }
    
    // Override all Bootstrap default white backgrounds with high specificity
    .bg-white,
    nav.bg-white,
    .navbar.bg-white,
    .topbar.bg-white,
    .card.bg-white,
    div.bg-white,
    section.bg-white,
    [class*="bg-white"] {
        background-color: var(--bs-gray-100) !important;
    }
    
    // Override Bootstrap bg-light utility everywhere
    .bg-light,
    .form-control.bg-light,
    .search-icon.bg-light,
    .search-results.bg-light,
    .input-group-text.bg-light,
    [class*="bg-light"] {
        background-color: var(--bs-gray-100) !important;
    }
    
    // Ensure all containers and wrappers have dark backgrounds
    .container,
    .container-fluid {
        background-color: transparent !important;
    }
    
    #wrapper {
        #content-wrapper {
            background-color: #1a1a1a !important;
            
            #content {
                background-color: #1a1a1a !important;
                
                .container-fluid {
                    background-color: transparent;
                }
            }
        }
    }
    
    // Topbar - override bg-white class
    .topbar.bg-white,
    .topbar {
        background-color: var(--bs-navbar-bg) !important;
        border-color: var(--bs-border-color) !important;
        
        .navbar-nav .nav-link {
            color: var(--bs-body-color) !important;
        }
        
        .dropdown-menu {
            background-color: var(--bs-dropdown-bg) !important;
            border-color: var(--bs-dropdown-border-color) !important;
            
            .dropdown-item {
                color: var(--bs-dropdown-link-color) !important;
                
                &:hover {
                    background-color: var(--bs-dropdown-link-hover-bg) !important;
                    color: var(--bs-dropdown-link-hover-color) !important;
                }
            }
        }
        
        // Search inputs
        .bg-light {
            background-color: var(--bs-input-bg) !important;
        }
        
        .form-control.bg-light {
            background-color: var(--bs-input-bg) !important;
            color: var(--bs-input-color) !important;
        }
        
        .search-icon.bg-light {
            background-color: var(--bs-input-bg) !important;
        }
    }
    
    // Cards - override any white backgrounds with maximum specificity
    .card,
    .card.bg-white,
    .card.shadow,
    .card.shadow-sm,
    .card.shadow-lg,
    div.card {
        background-color: var(--bs-card-bg) !important;
        border: none !important;
        color: var(--bs-body-color) !important;
    }
    
    .card-header {
        background-color: #2d2d2d !important;
        border-bottom: none !important;
        color: var(--bs-body-color) !important;
        
        &.bg-primary {
            background-color: var(--theme-primary) !important;
        }
    }
    
    .card-body {
        background-color: var(--bs-card-bg) !important;
        color: var(--bs-body-color) !important;
    }
    
    // Border left utilities (used in dashboard cards)
    .border-left-primary {
        border-left-color: var(--theme-primary) !important;
    }
    
    .border-left-success {
        border-left-color: var(--theme-success) !important;
    }
    
    .border-left-danger {
        border-left-color: var(--theme-danger) !important;
    }
    
    .border-left-info {
        border-left-color: var(--theme-info) !important;
    }
    
    .border-left-warning {
        border-left-color: var(--theme-warning) !important;
    }
    
    // Forms
    form {
        input, select, textarea {
            background-color: var(--bs-input-bg);
            border-color: var(--bs-input-border-color);
            color: var(--bs-input-color);
            
            &:focus {
                background-color: var(--bs-input-focus-bg);
                border-color: var(--bs-input-focus-border-color);
                color: var(--bs-input-focus-color);
            }
            
            &:disabled {
                background-color: var(--bs-navbar-bg);
                opacity: 0.6;
            }
        }
        
        .form-label {
            color: var(--bs-body-color);
        }
        
        .form-text {
            color: var(--bs-gray-900);
        }
        
        .form-check-label {
            color: var(--bs-body-color);
        }
    }
    
    // Tables
    .table {
        color: var(--bs-body-color) !important;
        background-color: transparent !important;
        
        thead {
            &.table-light {
                background-color: var(--bs-gray-100) !important;
                color: var(--bs-body-color) !important;
                
                th {
                    background-color: var(--bs-gray-100) !important;
                    color: var(--bs-body-color) !important;
                    border-color: var(--bs-border-color) !important;
                    
                    a {
                        color: var(--theme-tertiary) !important;
                        
                        &:hover {
                            color: var(--theme-tertiary) !important;
                        }
                    }
                }
            }
        }
        
        tbody {
            background-color: transparent !important;
            
            tr {
                color: var(--bs-body-color) !important;
                background-color: transparent !important;
                
                &:hover {
                    background-color: var(--bs-gray-100) !important;
                }
            }
        }
        
        th, td {
            border-color: var(--bs-border-color) !important;
            color: var(--bs-body-color) !important;
        }
        
        // Override .table-light class specifically
        &.table-light {
            th {
                background-color: var(--bs-gray-100) !important;
                color: var(--bs-body-color) !important;
                border-color: var(--bs-border-color) !important;
                
                a {
                    color: #dfebeb !important;
                    
                    &:hover {
                        color: #dfebeb !important;
                    }
                }
            }
        }
        
        &.table-striped {
            tbody tr:nth-of-type(odd) {
                background-color: rgba(255, 255, 255, 0.05);
            }
        }
    }
    
    // Page title
    .page-title {
        h3 {
            color: var(--bs-body-color);
        }
    }
    
    // Text colors
    .text-gray-800 {
        color: var(--bs-body-color) !important;
    }
    
    .text-primary {
        color: var(--theme-primary) !important;
    }
    
    // Links
    a {
        color: var(--theme-primary);
        
        &:hover {
            color: var(--theme-info);
        }
    }
    
    // Small text elements
    .small,
    small {
        color: var(--bs-gray-900) !important;
    }
    
    // Input groups
    .input-group {
        .input-group-prepend,
        .input-group-append {
            .input-group-text {
                background-color: var(--bs-input-bg) !important;
                border-color: var(--bs-input-border-color) !important;
                color: var(--bs-input-color) !important;
            }
        }
    }
    
    // Alerts
    .alert {
        &.alert-success {
            background-color: rgba(92, 184, 92, 0.2);
            border-color: var(--theme-success);
            color: var(--bs-body-color);
        }
        
        &.alert-danger {
            background-color: rgba(217, 83, 79, 0.2);
            border-color: var(--theme-danger);
            color: var(--bs-body-color);
        }
        
        &.alert-warning {
            background-color: rgba(240, 173, 78, 0.2);
            border-color: var(--theme-warning);
            color: var(--bs-body-color);
        }
        
        &.alert-info {
            background-color: rgba(91, 192, 222, 0.2);
            border-color: var(--theme-info);
            color: var(--bs-body-color);
        }
    }
    
    // Sidebar - handled in navs/_sidebar.scss, but ensure collapse items are styled
    .collapse-inner {
        background-color: var(--bs-gray-100) !important;
        
        .collapse-item {
            color: var(--bs-body-color) !important;
            
            &:hover {
                background-color: var(--bs-gray-200) !important;
            }
        }
    }
    
    // Dropdowns
    .dropdown-menu {
        background-color: var(--bs-dropdown-bg);
        border-color: var(--bs-dropdown-border-color);
        
        .dropdown-item {
            color: var(--bs-dropdown-link-color);
            
            &:hover, &:focus {
                background-color: var(--bs-dropdown-link-hover-bg);
                color: var(--bs-dropdown-link-hover-color);
            }
        }
        
        .dropdown-divider {
            border-top-color: var(--bs-gray-300);
        }
    }
    
    // Search inputs - override bg-light classes
    .navbar-search {
        .form-control,
        .form-control.bg-light {
            background-color: var(--bs-input-bg) !important;
            border-color: var(--bs-input-border-color) !important;
            color: var(--bs-input-color) !important;
        }
        
        .search-results,
        .search-results.bg-light,
        .search-results.shadow-sm {
            background-color: var(--bs-dropdown-bg) !important;
            border-color: var(--bs-dropdown-border-color) !important;
        }
        
        .search-icon,
        .search-icon.bg-light {
            background-color: var(--bs-input-bg) !important;
        }
    }
    
    // Copyable elements
    dl.copyable {
        dt {
            color: var(--bs-gray-900);
        }
        
        dd {
            color: var(--bs-body-color);
        }
    }
    
    // Separator
    dl dd.separator {
        border-bottom-color: var(--theme-primary);
    }
    
    // Buttons
    .btn {
        &.btn-light {
            background-color: var(--bs-gray-100);
            border-color: var(--bs-gray-300);
            color: var(--bs-body-color);
            
            &:hover {
                background-color: var(--bs-gray-200);
                border-color: var(--bs-gray-400);
            }
        }
    }
    
    // Badges
    .badge {
        &.text-bg-danger {
            background-color: var(--theme-danger) !important;
        }
    }
    
    // Pagination
    .fixed-table-pagination {
        div.float-left.pagination-detail > span.page-list > span > button {
            color: var(--bs-body-color) !important;
            background-color: var(--bs-gray-100) !important;
            border-color: var(--bs-gray-300) !important;
        }
    }
    
    // Timeline
    .timeline {
        li {
            border-left-color: var(--theme-primary);
            
            &:before {
                background: var(--bs-gray-100) !important;
                border-color: var(--theme-primary) !important;
            }
        }
        
        .time {
            color: var(--bs-gray-900);
        }
        
        p {
            color: var(--bs-body-color);
        }
    }
    
    // Link tooltip
    .link-tooltip {
        background-image: linear-gradient(90deg, #294661 33%, var(--bs-body-color) 0) !important;
    }
    
    // Front cover (keep white text as it's on background image)
    // White text is intentional for contrast on background image, no override needed
    
    // Text muted
    .text-muted {
        color: var(--bs-gray-900) !important;
    }
    
    // Small text
    small, .small {
        color: var(--bs-gray-900);
    }
    
    // Tooltips
    .tooltip {
        .tooltip-inner {
            background-color: var(--bs-gray-100);
            color: var(--bs-body-color);
        }
        
        .tooltip-arrow::before {
            border-top-color: var(--bs-gray-100);
            border-bottom-color: var(--bs-gray-100);
            border-left-color: var(--bs-gray-100);
            border-right-color: var(--bs-gray-100);
        }
    }
    
    // Modals
    .modal {
        .modal-content {
            background-color: var(--bs-tertiary-bg);
            border-color: var(--bs-border-color);
            color: var(--bs-body-color);
        }
        
        .modal-header {
            background-color: var(--bs-gray-100);
            border-bottom-color: var(--bs-border-color);
            color: var(--bs-body-color);
        }
        
        .modal-body {
            background-color: var(--bs-tertiary-bg);
            color: var(--bs-body-color);
        }
        
        .modal-footer {
            background-color: var(--bs-tertiary-bg);
            border-top-color: var(--bs-border-color);
        }
        
        .btn-close {
            filter: invert(1) grayscale(100%) brightness(200%);
        }
    }
    
    // Popovers
    .popover {
        background-color: var(--bs-gray-100);
        border-color: var(--bs-gray-300);
        color: var(--bs-body-color);
        
        .popover-header {
            background-color: var(--bs-gray-200);
            border-bottom-color: var(--bs-gray-300);
            color: var(--bs-body-color);
        }
        
        .popover-body {
            color: var(--bs-body-color);
        }
        
        .popover-arrow::before {
            border-top-color: var(--bs-gray-300);
            border-bottom-color: var(--bs-gray-300);
            border-left-color: var(--bs-gray-300);
            border-right-color: var(--bs-gray-300);
        }
    }
    
    // Accordion
    .accordion {
        .accordion-item {
            background-color: var(--bs-tertiary-bg);
            border-color: var(--bs-border-color);
        }
        
        .accordion-header {
            .accordion-button {
                background-color: var(--bs-gray-100);
                color: var(--bs-body-color);
                
                &:not(.collapsed) {
                    background-color: var(--bs-gray-200);
                    color: var(--bs-emphasis-color);
                }
            }
        }
        
        .accordion-body {
            background-color: var(--bs-tertiary-bg);
            color: var(--bs-body-color);
        }
    }
    
    // List group
    .list-group {
        .list-group-item {
            background-color: var(--bs-tertiary-bg);
            border-color: var(--bs-border-color);
            color: var(--bs-body-color);
            
            &:hover {
                background-color: var(--bs-gray-100);
            }
            
            &.active {
                background-color: var(--theme-primary);
                border-color: var(--theme-primary);
            }
        }
    }
}

// Set container padding to match gutter width instead of default 15px
.container,
.container-fluid {
    padding-left: $grid-gutter-width;
    padding-right: $grid-gutter-width;
}

// Custom extras
.front-cover {
    width: 100%;
    height: 100vh;

    background: url("../images/front.jpg");
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
    background-position: 50% 50%;

    .content {
        width: fit-content;
        margin: auto;
        text-align: center;

        padding-top: 200px;

        @include media-breakpoint-down(md) {
            width: 90%;
        }

        &-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            font-size: 3rem;
            color: white;

            img {
                height: 3rem;
            }

            @include media-breakpoint-down(sm) {
                flex-direction: column;
                gap: 0.5rem;
                font-size: 2rem;
            }
        }

        &-description {
            font-size: 1.375rem;
            color: white;

            @include media-breakpoint-down(sm) {
                margin-top: 0.5rem;
                font-size: 1rem;
            }
        }

        a {
            margin-top: 1.25rem;
            padding-top: 0.375;
            width: 100%;
        }
    }

    .logo {
        position: absolute;
        bottom: 1.25rem;
        left: calc(50vw - (14.5rem / 2));

        img {
            width: 14.5rem;
        }
    }
}

.table {
    &-leftpadded {
        thead,
        tbody {
            th:first-child,
            td:first-child {
                padding-left: 1rem;
            }
        }
    }

    .table-dark,
    .tbody-dark {
        th {
            border-color: $blue;
            background-color: $blue;
        }
    }

    .table-light {
        th {
            color: $gray-800;
            background: $gray-200;
        }
    }

    tr {
        color: $gray-800;
    }

    td {
        color: $gray-900;
    }
}

// Dark theme overrides for base table styles
[data-theme="dark"] {
    .table {
        tr {
            color: var(--bs-body-color) !important;
        }
        
        td {
            color: var(--bs-body-color) !important;
        }
        
        .table-light {
            th {
                background-color: var(--bs-gray-100) !important;
                color: var(--bs-body-color) !important;
                border-color: var(--bs-border-color) !important;
                
                a {
                    color: #dfebeb !important;
                    
                    &:hover {
                        color: #dfebeb !important;
                    }
                }
            }
        }
    }
}

// Lets tweak a bit the style of bootstrap-table plugin
table[data-toggle="table"] {
    th {
        &:first-child {
            padding-left: 0.5rem !important;
        }

        &:last-child {
            padding-right: 0.5rem !important;
        }
    }

    .filter-control {
        input {
            height: calc(1.25em + 0.5rem + 2px);
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        select {
            height: calc(1.25em + 0.5rem + 2px);
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }
    }
}

table{

    a {
        text-decoration: none;

        &.dotted-underline{
            text-decoration: dotted underline;
        }

        &:hover:not([role="button"]){
            text-decoration: underline;
        }
    }

    .table-card{

        width: 100%;

        th,td{
            vertical-align: baseline;
        }

        th{
            width: 10ch;
        }

        tr.spacing > td{
            padding-bottom: 1rem;
        }
        tr.spacing > th{
            padding-bottom: 1rem;
        }
    }
}

// Tweaks to the pagination of bootstrap-table plugin, fixes padding issues and more
.fixed-table-pagination {
    padding-left: 1rem;
    padding-right: 1rem;

    // Forcefully changing the rows for each page dropdown, as we can't change the html afaik
    div.float-left.pagination-detail > span.page-list > span > button {
        color: $gray-900;
        background-color: $gray-100 !important;
        border-color: $gray-200 !important;

        height: calc(1.5em + 0.5rem + 2px);
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
        line-height: 1.5;
    }
}

.link-tooltip{
    text-decoration: none;
    background-image: linear-gradient(90deg,#294661 33%,#fff 0);
    background-repeat: repeat-x;
    background-position: bottom;
    background-size: 3px 1px;
}

.tooltip-inner {
    text-align: left;
    white-space: pre-line;
    max-width: 50vw !important;
}

.endorsement-card{
    width: 18rem;
    @include media-breakpoint-down(md) {
        width: 100%;
    }
}

.timeline{

    max-height: 75vh;
    overflow-y: auto;

    .sessions{
        margin-top: 2rem;
        border-radius: 12px;
        position: relative;
        width: calc(100% - 20px);
    }

    ul, li{
        list-style: none;
        padding: 0;
    }

    li{
        padding-bottom: 1.5rem;
        border-left: 1px solid $primary;
        position: relative;
        padding-left: 1.25rem;
        margin-left: 1.5rem;

        &:last-child{
            border: 0px;
            padding-bottom: 0;
        }

        &:before{
            content: '';
            width: 15px;
            height: 15px;
            background: $white;
            border: 1px solid $primary;
            border-radius: 50%;
            position: absolute;
            left: -0.5rem;
            top: 0rem;
        }
    }

    .time{
        color: $gray-600;
        font-size: 0.8rem;
    }

    p{
        line-height: 1.5;
        margin-top:0.4rem;
    }
}

.submit-spinner {
    display: none;
    margin-left: 8px;
    margin-bottom: 3px;
    vertical-align: middle;
}

.flatpickr-calendar {
    background-color: var(--bs-gray-100) !important;
}

.flatpickr-current-month {
    color: #fff !important;
}

.flatpickr-weekday {
    color: #eee !important;
}

.flatpickr-day {
    color: #eee !important;
}

.flatpickr-day.in-range {
    background-color: var(--bs-gray-100) !important;
    color: #eee !important;
}

.flatpickr-day.selected {
    background-color: var(--theme-primary) !important;
    color: #fff !important;
}