name: Run Tests

on:
  pull_request:
    branches: [ master ]

jobs:
  test-app:
    runs-on: ubuntu-latest
    steps:
    - name: Setup Handover
      uses: ./.github/workflows/setup-project.yaml
      with:
        repository: handover

    - name: Setup Control Center
      uses: ./.github/workflows/setup-project.yaml
      with:
        repository: controlcenter
        setup-node: true

    - name: Execute unit and feature tests via PHPUnit
      run: ./vendor/bin/phpunit --color=always --testdox
      working-directory: ./controlcenter
